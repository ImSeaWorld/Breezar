import{d as Q,r as D,c as h,o as f,w as t,a as i,b as e,Q as b,e as x,f as d,t as n,g as A,h as S,i as U,j as T}from"./app-B9ngRPxC.js";import{Q as g,a as C}from"./QSelect-U9GO-vcy.js";import{Q as w}from"./QInput-CJt-xT-X.js";import{_ as k,Q as p,a as _}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as q,a as m}from"./QTable-BWQ-_2Rh.js";import{Q as F}from"./QTooltip-BzpgTjjf.js";import{A as R,Q as I,C as O}from"./Authenticated-Bi_brb96.js";import{Q as L}from"./QSeparator-DlYTESWS.js";import{Q as c}from"./QItemLabel-CDx0sUKF.js";import{Q as y}from"./QItemSection-Dr7pKUWg.js";import{Q as v}from"./QItem-DGC_oh8H.js";import{Q as N}from"./QList-CauX3dmB.js";import{Q as B}from"./QDialog-Bd7-soYq.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./format-DSaZ9Sxz.js";import"./use-model-toggle-D3uVg552.js";import"./use-timeout-BLTl8fd9.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const P={components:{AuthenticatedLayout:R},props:{activities:Object,actions:Array,resourceTypes:Array,users:Array,filters:Object},data(){return{showDetailsDialog:!1,selectedActivity:null,columns:[{name:"user",label:"User",align:"left"},{name:"action",label:"Action",field:"action",align:"left"},{name:"resource",label:"Resource",align:"left"},{name:"created_at",label:"Date/Time",field:"created_at",align:"left"},{name:"details",label:"",align:"center"}]}},computed:{tablePagination(){return{page:this.activities.current_page,rowsPerPage:this.activities.per_page,rowsNumber:this.activities.total}},userOptions(){return this.users.map(o=>({label:o.name,value:o.id}))},actionOptions(){return this.actions.map(o=>({label:this.formatAction(o),value:o}))},resourceTypeOptions(){return this.resourceTypes.filter(o=>o!=null).map(o=>({label:this.formatResourceType(o),value:o}))}},methods:{formatDateTime(o){return new Date(o).toLocaleString()},formatAction(o){return o.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())},formatResourceType(o){return o?o.charAt(0).toUpperCase()+o.slice(1):"Unknown"},getActionColor(o){return o.includes("created")?"positive":o.includes("updated")?"primary":o.includes("deleted")||o.includes("failed")?"negative":o.includes("executed")?"secondary":o.includes("viewed")?"info":"grey"},applyFilters(){this.$inertia.get(route("activity.index"),this.filters,{preserveState:!0,preserveScroll:!0})},debouncedSearch:Q(function(){this.applyFilters()},500),onRequest(o){const{page:a}=o.pagination;this.$inertia.get(route("activity.index"),{...this.filters,page:a},{preserveState:!0,preserveScroll:!0})},refreshActivities(){this.$inertia.reload({preserveState:!0,preserveScroll:!0})},showDetails(o){this.selectedActivity=o,this.showDetailsDialog=!0}}},j={class:"q-gutter-md"},z={class:"row items-center justify-between q-mb-md"},E={class:"row q-col-gutter-md"},J={class:"col-12 col-md-3"},M={class:"col-12 col-md-3"},G={class:"col-12 col-md-3"},H={class:"col-12 col-md-3"},K={class:"col-12 col-md-3"},W={class:"col-12 col-md-3"},X={key:0,class:"flex items-center"},Y={class:"q-ml-sm"},Z={key:1,class:"text-grey-6"},$={class:"text-weight-medium"},ee={class:"text-caption text-grey-7"},te={class:"row q-col-gutter-md"},le={class:"col-12 col-md-6"},ae={class:"col-12 col-md-6"},oe={class:"q-ma-none"};function ie(o,a,s,re,u,r){const V=D("AuthenticatedLayout");return f(),h(V,null,{default:t(()=>[i("div",j,[i("div",z,[a[7]||(a[7]=i("div",{class:"text-h5"},"Activity Logs",-1)),e(b,{color:"primary",icon:"mdi-refresh",label:"Refresh",onClick:r.refreshActivities},null,8,["onClick"])]),e(p,null,{default:t(()=>[e(_,null,{default:t(()=>[i("div",E,[i("div",J,[e(g,{modelValue:s.filters.user_id,"onUpdate:modelValue":[a[0]||(a[0]=l=>s.filters.user_id=l),r.applyFilters],options:r.userOptions,label:"Filter by User",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),i("div",M,[e(g,{modelValue:s.filters.action,"onUpdate:modelValue":[a[1]||(a[1]=l=>s.filters.action=l),r.applyFilters],options:r.actionOptions,label:"Filter by Action",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),i("div",G,[e(g,{modelValue:s.filters.resource_type,"onUpdate:modelValue":[a[2]||(a[2]=l=>s.filters.resource_type=l),r.applyFilters],options:r.resourceTypeOptions,label:"Filter by Resource Type",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),i("div",H,[e(w,{modelValue:s.filters.search,"onUpdate:modelValue":[a[3]||(a[3]=l=>s.filters.search=l),r.debouncedSearch],label:"Search",filled:"",clearable:""},{prepend:t(()=>[e(x,{name:"mdi-magnify"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),i("div",K,[e(w,{modelValue:s.filters.date_from,"onUpdate:modelValue":[a[4]||(a[4]=l=>s.filters.date_from=l),r.applyFilters],label:"Date From",filled:"",type:"date",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),i("div",W,[e(w,{modelValue:s.filters.date_to,"onUpdate:modelValue":[a[5]||(a[5]=l=>s.filters.date_to=l),r.applyFilters],label:"Date To",filled:"",type:"date",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])])]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(q,{rows:s.activities.data,columns:u.columns,"row-key":"id",flat:"",pagination:r.tablePagination,onRequest:r.onRequest},{"body-cell-user":t(l=>[e(m,{props:l},{default:t(()=>[l.row.user?(f(),A("div",X,[e(S,{size:"24px",color:"primary","text-color":"white"},{default:t(()=>[d(n(l.row.user.name.charAt(0)),1)]),_:2},1024),i("span",Y,n(l.row.user.name),1)])):(f(),A("span",Z,"System"))]),_:2},1032,["props"])]),"body-cell-action":t(l=>[e(m,{props:l},{default:t(()=>[e(C,{size:"sm",color:r.getActionColor(l.row.action),"text-color":"white"},{default:t(()=>[d(n(r.formatAction(l.row.action)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-resource":t(l=>[e(m,{props:l},{default:t(()=>[i("div",null,[i("div",$,n(l.row.resource_type),1),i("div",ee,"ID: "+n(l.row.resource_id),1)])]),_:2},1032,["props"])]),"body-cell-details":t(l=>[e(m,{props:l},{default:t(()=>[e(b,{size:"sm",flat:"",dense:"",icon:"mdi-information",onClick:se=>r.showDetails(l.row)},{default:t(()=>[e(F,null,{default:t(()=>a[8]||(a[8]=[d("View Details",-1)])),_:1,__:[8]})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),"body-cell-created_at":t(l=>[e(m,{props:l},{default:t(()=>[d(n(r.formatDateTime(l.row.created_at)),1)]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"])]),_:1}),e(B,{modelValue:u.showDetailsDialog,"onUpdate:modelValue":a[6]||(a[6]=l=>u.showDetailsDialog=l),maximized:""},{default:t(()=>[e(p,null,{default:t(()=>[e(_,{class:"row items-center"},{default:t(()=>[a[9]||(a[9]=i("div",{class:"text-h6"},"Activity Details",-1)),e(I),T(e(b,{icon:"mdi-close",flat:"",round:"",dense:""},null,512),[[O]])]),_:1,__:[9]}),e(L),u.selectedActivity?(f(),h(_,{key:0},{default:t(()=>[i("div",te,[i("div",le,[e(N,{bordered:"",separator:""},{default:t(()=>[e(v,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{caption:""},{default:t(()=>a[10]||(a[10]=[d("User",-1)])),_:1,__:[10]}),e(c,null,{default:t(()=>{var l;return[d(n(((l=u.selectedActivity.user)==null?void 0:l.name)||"System"),1)]}),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{caption:""},{default:t(()=>a[11]||(a[11]=[d("Action",-1)])),_:1,__:[11]}),e(c,null,{default:t(()=>[d(n(r.formatAction(u.selectedActivity.action)),1)]),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{caption:""},{default:t(()=>a[12]||(a[12]=[d("Resource",-1)])),_:1,__:[12]}),e(c,null,{default:t(()=>[d(n(u.selectedActivity.resource_type)+" (ID: "+n(u.selectedActivity.resource_id)+") ",1)]),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{caption:""},{default:t(()=>a[13]||(a[13]=[d("Date/Time",-1)])),_:1,__:[13]}),e(c,null,{default:t(()=>[d(n(r.formatDateTime(u.selectedActivity.created_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),i("div",ae,[a[14]||(a[14]=i("div",{class:"text-subtitle2 q-mb-sm"},"Metadata",-1)),e(p,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[i("pre",oe,n(JSON.stringify(u.selectedActivity.metadata,null,2)),1)]),_:1})]),_:1})])])]),_:1})):U("",!0)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Fe=k(P,[["render",ie],["__scopeId","data-v-3323a353"]]);export{Fe as default};
