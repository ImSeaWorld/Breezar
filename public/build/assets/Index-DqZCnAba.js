import{Z as V,r as y,c as R,o as C,w as l,a as i,b as t,Q as p,f as m,t as d,j as Q,L as F}from"./app-B9ngRPxC.js";import{Q as f,a as k}from"./QSelect-U9GO-vcy.js";import{Q as _}from"./QInput-CJt-xT-X.js";import{_ as S,Q as c,a as g}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as D,a as u}from"./QTable-BWQ-_2Rh.js";import{Q as w}from"./QTooltip-BzpgTjjf.js";import{Q as q}from"./QCardActions-BXiB0Jwk.js";import{Q as U}from"./QForm-QL7SKRAj.js";import{Q as x}from"./QDialog-Bd7-soYq.js";import{A as T,C as G}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./QItem-DGC_oh8H.js";import"./QItemSection-Dr7pKUWg.js";import"./QItemLabel-CDx0sUKF.js";import"./format-DSaZ9Sxz.js";import"./QList-CauX3dmB.js";import"./use-timeout-BLTl8fd9.js";import"./use-model-toggle-D3uVg552.js";import"./QSeparator-DlYTESWS.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const L={components:{AuthenticatedLayout:T,Link:V},props:{reports:Object,clients:Array,filters:Object},data(){return{showGenerateDialog:!1,generating:!1,generateForm:F({client_id:null,type:null,month:new Date().toISOString().slice(0,7)}),columns:[{name:"client",label:"Client",field:"client",align:"left"},{name:"type",label:"Type",field:"type",align:"center"},{name:"report_month",label:"Month",field:"report_month",align:"left"},{name:"generated_at",label:"Generated",field:"generated_at",align:"left"},{name:"actions",label:"Actions",align:"center"}],typeOptions:[{label:"Usage Report",value:"usage"},{label:"Performance Report",value:"performance"},{label:"Work Items Report",value:"work_items"},{label:"Custom Report",value:"custom"}]}},computed:{clientOptions(){return this.clients.map(r=>({label:r.name,value:r.id}))},tablePagination(){return{page:this.reports.current_page,rowsPerPage:this.reports.per_page,rowsNumber:this.reports.total}}},methods:{formatType(r){return{usage:"Usage",performance:"Performance",work_items:"Work Items",custom:"Custom"}[r]||r},getTypeColor(r){return{usage:"primary",performance:"secondary",work_items:"accent",custom:"info"}[r]||"grey"},formatMonth(r){return new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long"})},formatDate(r){return new Date(r).toLocaleString()},applyFilters(){this.$inertia.get(route("reports.index"),this.filters,{preserveState:!0,preserveScroll:!0})},onRequest(r){const{page:o}=r.pagination;this.$inertia.get(route("reports.index"),{...this.filters,page:o},{preserveState:!0,preserveScroll:!0})},viewReport(r){this.$inertia.visit(route("reports.show",r))},downloadReport(r){window.open(route("reports.download",r),"_blank")},generateReport(){this.generating=!0,this.generateForm.post(route("reports.generate"),{onSuccess:()=>{this.$q.notify({type:"positive",message:"Report generation started"}),this.showGenerateDialog=!1,this.generateForm.reset()},onError:()=>{this.$q.notify({type:"negative",message:"Failed to generate report"})},onFinish:()=>{this.generating=!1}})}}},O={class:"q-gutter-md"},A={class:"row items-center justify-between q-mb-md"},P={class:"row q-col-gutter-md"},M={class:"col-12 col-md-4"},I={class:"col-12 col-md-4"},N={class:"col-12 col-md-4"},j={class:"q-gutter-md"};function B(r,o,s,z,a,n){const b=y("Link"),h=y("AuthenticatedLayout");return C(),R(h,null,{default:l(()=>[i("div",O,[i("div",A,[o[8]||(o[8]=i("div",{class:"text-h5"},"Reports",-1)),t(p,{color:"primary",icon:"mdi-plus",label:"Generate Report",onClick:o[0]||(o[0]=e=>a.showGenerateDialog=!0)})]),t(c,null,{default:l(()=>[t(g,null,{default:l(()=>[i("div",P,[i("div",M,[t(f,{modelValue:s.filters.client_id,"onUpdate:modelValue":[o[1]||(o[1]=e=>s.filters.client_id=e),n.applyFilters],options:n.clientOptions,label:"Filter by Client",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),i("div",I,[t(f,{modelValue:s.filters.type,"onUpdate:modelValue":[o[2]||(o[2]=e=>s.filters.type=e),n.applyFilters],options:a.typeOptions,label:"Filter by Type",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])]),i("div",N,[t(_,{modelValue:s.filters.month,"onUpdate:modelValue":[o[3]||(o[3]=e=>s.filters.month=e),n.applyFilters],label:"Filter by Month",filled:"",type:"month",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])])]),_:1})]),_:1}),t(c,null,{default:l(()=>[t(D,{rows:s.reports.data,columns:a.columns,"row-key":"id",flat:"",pagination:n.tablePagination,onRequest:n.onRequest},{"body-cell-client":l(e=>[t(u,{props:e},{default:l(()=>[t(b,{href:r.route("clients.show",e.row.client.id),class:"text-primary text-weight-medium"},{default:l(()=>[m(d(e.row.client.name),1)]),_:2},1032,["href"])]),_:2},1032,["props"])]),"body-cell-type":l(e=>[t(u,{props:e},{default:l(()=>[t(k,{size:"sm",color:n.getTypeColor(e.row.type)},{default:l(()=>[m(d(n.formatType(e.row.type)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-report_month":l(e=>[t(u,{props:e},{default:l(()=>[m(d(n.formatMonth(e.row.report_month)),1)]),_:2},1032,["props"])]),"body-cell-generated_at":l(e=>[t(u,{props:e},{default:l(()=>[m(d(n.formatDate(e.row.generated_at)),1)]),_:2},1032,["props"])]),"body-cell-actions":l(e=>[t(u,{props:e},{default:l(()=>[t(p,{size:"sm",flat:"",dense:"",icon:"mdi-eye",onClick:v=>n.viewReport(e.row.id)},{default:l(()=>[t(w,null,{default:l(()=>o[9]||(o[9]=[m("View Report",-1)])),_:1,__:[9]})]),_:2},1032,["onClick"]),t(p,{size:"sm",flat:"",dense:"",icon:"mdi-download",onClick:v=>n.downloadReport(e.row.id)},{default:l(()=>[t(w,null,{default:l(()=>o[10]||(o[10]=[m("Download Report",-1)])),_:1,__:[10]})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"])]),_:1}),t(x,{modelValue:a.showGenerateDialog,"onUpdate:modelValue":o[7]||(o[7]=e=>a.showGenerateDialog=e)},{default:l(()=>[t(c,{style:{"min-width":"400px"}},{default:l(()=>[t(U,{onSubmit:n.generateReport},{default:l(()=>[t(g,null,{default:l(()=>o[11]||(o[11]=[i("div",{class:"text-h6"},"Generate New Report",-1)])),_:1,__:[11]}),t(g,null,{default:l(()=>[i("div",j,[t(f,{modelValue:a.generateForm.client_id,"onUpdate:modelValue":o[4]||(o[4]=e=>a.generateForm.client_id=e),options:n.clientOptions,label:"Select Client",filled:"","emit-value":"","map-options":"",rules:[e=>!!e||"Client is required"]},null,8,["modelValue","options","rules"]),t(f,{modelValue:a.generateForm.type,"onUpdate:modelValue":o[5]||(o[5]=e=>a.generateForm.type=e),options:a.typeOptions,label:"Report Type",filled:"","emit-value":"","map-options":"",rules:[e=>!!e||"Report type is required"]},null,8,["modelValue","options","rules"]),t(_,{modelValue:a.generateForm.month,"onUpdate:modelValue":o[6]||(o[6]=e=>a.generateForm.month=e),label:"Report Month",filled:"",type:"month",rules:[e=>!!e||"Month is required"]},null,8,["modelValue","rules"])])]),_:1}),t(q,{align:"right"},{default:l(()=>[Q(t(p,{flat:"",label:"Cancel"},null,512),[[G]]),t(p,{type:"submit",color:"primary",label:"Generate",loading:a.generating},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const we=S(L,[["render",B]]);export{we as default};
