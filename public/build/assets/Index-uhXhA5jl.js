import{d as v,r as D,c as C,o as p,w as t,a as i,b as l,Q as u,e as w,f as r,t as n,g as b,h as Q,j as U}from"./app-B9ngRPxC.js";import{Q as x}from"./QInput-CJt-xT-X.js";import{Q as k,a as A}from"./QSelect-U9GO-vcy.js";import{_ as V,Q as _,a as g}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as S,a as c}from"./QTable-BWQ-_2Rh.js";import{Q as f}from"./QTooltip-BzpgTjjf.js";import{Q as q}from"./QCardActions-BXiB0Jwk.js";import{Q as F}from"./QDialog-Bd7-soYq.js";import{A as z,C as R}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./QItem-DGC_oh8H.js";import"./QItemSection-Dr7pKUWg.js";import"./QItemLabel-CDx0sUKF.js";import"./format-DSaZ9Sxz.js";import"./QList-CauX3dmB.js";import"./use-timeout-BLTl8fd9.js";import"./use-model-toggle-D3uVg552.js";import"./QSeparator-DlYTESWS.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const B={components:{AuthenticatedLayout:z},props:{users:Object,filters:Object},data(){return{showDeleteDialog:!1,selectedUser:null,deleting:!1,columns:[{name:"name",label:"User",field:"name",align:"left"},{name:"role",label:"Role",field:"role",align:"center"},{name:"clients_count",label:"Clients",field:"clients_count",align:"center"},{name:"two_factor",label:"2FA",align:"center"},{name:"created_at",label:"Created",field:"created_at",align:"left"},{name:"actions",label:"Actions",align:"center"}],roleOptions:[{label:"Admin",value:"admin"},{label:"Manager",value:"manager"}]}},computed:{tablePagination(){return{page:this.users.current_page,rowsPerPage:this.users.per_page,rowsNumber:this.users.total}}},methods:{formatDate(s){return new Date(s).toLocaleDateString()},applyFilters(){this.$inertia.get(route("users.index"),this.filters,{preserveState:!0,preserveScroll:!0})},debouncedSearch:v(function(){this.applyFilters()},500),onRequest(s){const{page:o}=s.pagination;this.$inertia.get(route("users.index"),{...this.filters,page:o},{preserveState:!0,preserveScroll:!0})},viewUser(s){this.$inertia.visit(route("users.show",s))},editUser(s){this.$inertia.visit(route("users.edit",s))},confirmDelete(s){this.selectedUser=s,this.showDeleteDialog=!0},deleteUser(){this.deleting=!0,this.$inertia.delete(route("users.destroy",this.selectedUser.id),{onSuccess:()=>{this.$q.notify({type:"positive",message:"User deleted successfully"}),this.showDeleteDialog=!1},onError:()=>{this.$q.notify({type:"negative",message:"Failed to delete user"})},onFinish:()=>{this.deleting=!1}})}}},P={class:"q-gutter-md"},T={class:"row items-center justify-between q-mb-md"},j={class:"row q-col-gutter-md"},E={class:"col-12 col-md-6"},L={class:"col-12 col-md-6"},N={class:"flex items-center"},O={class:"q-ml-sm"},I={class:"text-weight-medium"},M={class:"text-caption text-grey-7"},G={key:0,class:"text-grey-6"},H={key:1};function J(s,o,m,K,d,a){const y=D("AuthenticatedLayout");return p(),C(y,null,{default:t(()=>[i("div",P,[i("div",T,[o[4]||(o[4]=i("div",{class:"text-h5"},"Users",-1)),l(u,{color:"primary",icon:"mdi-plus",label:"Add User",onClick:o[0]||(o[0]=e=>s.$inertia.visit(s.route("users.create")))})]),l(_,null,{default:t(()=>[l(g,null,{default:t(()=>[i("div",j,[i("div",E,[l(x,{modelValue:m.filters.search,"onUpdate:modelValue":[o[1]||(o[1]=e=>m.filters.search=e),a.debouncedSearch],label:"Search users",filled:"",clearable:""},{prepend:t(()=>[l(w,{name:"mdi-magnify"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),i("div",L,[l(k,{modelValue:m.filters.role,"onUpdate:modelValue":[o[2]||(o[2]=e=>m.filters.role=e),a.applyFilters],options:d.roleOptions,label:"Filter by Role",filled:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"])])])]),_:1})]),_:1}),l(_,null,{default:t(()=>[l(S,{rows:m.users.data,columns:d.columns,"row-key":"id",flat:"",pagination:a.tablePagination,onRequest:a.onRequest},{"body-cell-name":t(e=>[l(c,{props:e},{default:t(()=>[i("div",N,[l(Q,{size:"32px",color:"primary","text-color":"white"},{default:t(()=>[r(n(e.row.name.charAt(0)),1)]),_:2},1024),i("div",O,[i("div",I,n(e.row.name),1),i("div",M,n(e.row.email),1)])])]),_:2},1032,["props"])]),"body-cell-role":t(e=>[l(c,{props:e},{default:t(()=>[l(A,{color:e.row.role==="admin"?"primary":"secondary","text-color":"white",size:"sm"},{default:t(()=>[r(n(e.row.role),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-clients_count":t(e=>[l(c,{props:e},{default:t(()=>[e.row.role==="admin"?(p(),b("span",G,"All Clients")):(p(),b("span",H,n(e.row.clients_count),1))]),_:2},1032,["props"])]),"body-cell-two_factor":t(e=>[l(c,{props:e},{default:t(()=>[l(w,{name:e.row.two_factor_secret?"mdi-shield-check":"mdi-shield-off",color:e.row.two_factor_secret?"positive":"grey",size:"20px"},{default:t(()=>[l(f,null,{default:t(()=>[r(n(e.row.two_factor_secret?"2FA Enabled":"2FA Disabled"),1)]),_:2},1024)]),_:2},1032,["name","color"])]),_:2},1032,["props"])]),"body-cell-created_at":t(e=>[l(c,{props:e},{default:t(()=>[r(n(a.formatDate(e.row.created_at)),1)]),_:2},1032,["props"])]),"body-cell-actions":t(e=>[l(c,{props:e},{default:t(()=>[l(u,{size:"sm",flat:"",dense:"",icon:"mdi-eye",onClick:h=>a.viewUser(e.row.id)},{default:t(()=>[l(f,null,{default:t(()=>o[5]||(o[5]=[r("View",-1)])),_:1,__:[5]})]),_:2},1032,["onClick"]),l(u,{size:"sm",flat:"",dense:"",icon:"mdi-pencil",onClick:h=>a.editUser(e.row.id)},{default:t(()=>[l(f,null,{default:t(()=>o[6]||(o[6]=[r("Edit",-1)])),_:1,__:[6]})]),_:2},1032,["onClick"]),l(u,{size:"sm",flat:"",dense:"",icon:"mdi-delete",color:"negative",onClick:h=>a.confirmDelete(e.row),disable:e.row.id===s.$page.props.auth.user.id},{default:t(()=>[l(f,null,{default:t(()=>o[7]||(o[7]=[r("Delete",-1)])),_:1,__:[7]})]),_:2},1032,["onClick","disable"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"])]),_:1}),l(F,{modelValue:d.showDeleteDialog,"onUpdate:modelValue":o[3]||(o[3]=e=>d.showDeleteDialog=e)},{default:t(()=>[l(_,{style:{"min-width":"300px"}},{default:t(()=>[l(g,null,{default:t(()=>o[8]||(o[8]=[i("div",{class:"text-h6"},"Delete User",-1)])),_:1,__:[8]}),l(g,null,{default:t(()=>{var e;return[r(' Are you sure you want to delete user "'+n((e=d.selectedUser)==null?void 0:e.name)+'"? This action cannot be undone. ',1)]}),_:1}),l(q,{align:"right"},{default:t(()=>[U(l(u,{flat:"",label:"Cancel"},null,512),[[R]]),l(u,{flat:"",label:"Delete",color:"negative",onClick:a.deleteUser,loading:d.deleting},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const ve=V(B,[["render",J]]);export{ve as default};
