import{Z as A,r as D,c as y,o as _,w as e,a as s,b as t,t as o,f as n,Q as f,i as v,g as w,R,S as V,j as b}from"./app-B9ngRPxC.js";import{Q as M}from"./QBtnGroup-uFzmfQIw.js";import{Q as u}from"./QItemLabel-CDx0sUKF.js";import{a as Q}from"./QSelect-U9GO-vcy.js";import{Q as p}from"./QItemSection-Dr7pKUWg.js";import{Q as h}from"./QItem-DGC_oh8H.js";import{Q as U}from"./QList-CauX3dmB.js";import{_ as F,Q as g,a as d}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as B,a as C}from"./QTable-BWQ-_2Rh.js";import{Q as S}from"./QCardActions-BXiB0Jwk.js";import{Q as x}from"./QDialog-Bd7-soYq.js";import{A as N,C as k}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./format-DSaZ9Sxz.js";import"./use-model-toggle-D3uVg552.js";import"./use-timeout-BLTl8fd9.js";import"./QSeparator-DlYTESWS.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QToolbar-tVFOb00I.js";import"./touch-BjYP5sR0.js";const j={components:{AuthenticatedLayout:N,Link:A},props:{instance:Object,machines:Array,logs:Array,metrics:Object},data(){return{showRestartDialog:!1,showStopDialog:!1,showStartDialog:!1,actionLoading:!1,machineColumns:[{name:"id",label:"Machine ID",field:"id",align:"left"},{name:"state",label:"State",field:"state",align:"center"},{name:"region",label:"Region",field:"region",align:"left"},{name:"createdAt",label:"Created",field:"createdAt",align:"left"}]}},methods:{formatDate(c){return new Date(c).toLocaleString()},formatMetric(c){return c?c.toFixed(2):"0.00"},getStatusColor(c){return{running:"positive",stopped:"negative",partial:"warning",not_deployed:"grey",no_machines:"grey"}[c]||"grey"},getMachineStateColor(c){return{started:"positive",stopped:"negative",stopping:"warning",starting:"info",destroyed:"grey"}[c]||"grey"},confirmRestart(){this.showRestartDialog=!0},confirmStop(){this.showStopDialog=!0},confirmStart(){this.showStartDialog=!0},restartInstance(){this.actionLoading=!0,this.$inertia.post(route("instances.restart",this.instance.id),{},{preserveScroll:!0,onSuccess:()=>{this.$q.notify({type:"positive",message:"Instance restart initiated"}),this.showRestartDialog=!1},onError:()=>{this.$q.notify({type:"negative",message:"Failed to restart instance"})},onFinish:()=>{this.actionLoading=!1}})},stopInstance(){this.actionLoading=!0,this.$inertia.post(route("instances.stop",this.instance.id),{},{preserveScroll:!0,onSuccess:()=>{this.$q.notify({type:"positive",message:"Instance stopped"}),this.showStopDialog=!1},onError:()=>{this.$q.notify({type:"negative",message:"Failed to stop instance"})},onFinish:()=>{this.actionLoading=!1}})},startInstance(){this.actionLoading=!0,this.$inertia.post(route("instances.start",this.instance.id),{},{preserveScroll:!0,onSuccess:()=>{this.$q.notify({type:"positive",message:"Instance started"}),this.showStartDialog=!1},onError:()=>{this.$q.notify({type:"negative",message:"Failed to start instance"})},onFinish:()=>{this.actionLoading=!1}})},openConsole(){this.$inertia.visit(route("instances.console",this.instance.id))}}},z={class:"q-gutter-md"},E={class:"row items-center justify-between q-mb-md"},O={class:"text-h5"},P={class:"text-caption text-grey-7"},T={class:"row q-col-gutter-md"},G={class:"col-12 col-md-4"},J={class:"q-ma-none text-caption"},Z={class:"col-12 col-md-8"},H={class:"log-container q-pa-sm bg-grey-10 text-white",style:{height:"300px","overflow-y":"auto","font-family":"monospace","font-size":"12px"}},K={key:0,class:"text-grey-5"},W={class:"row q-col-gutter-md"},X={class:"col-6"},Y={class:"text-h4"},$={class:"col-6"},tt={class:"text-h4"};function et(c,l,a,lt,m,r){const L=D("Link"),q=D("AuthenticatedLayout");return _(),y(q,null,{default:e(()=>[s("div",z,[s("div",E,[s("div",null,[s("div",O,"Instance: "+o(a.instance.fly_app_id),1),s("div",P,[t(L,{href:c.route("clients.show",a.instance.client.id),class:"text-primary"},{default:e(()=>[n(o(a.instance.client.name),1)]),_:1},8,["href"]),n(" | "+o(a.instance.type.toUpperCase())+" | "+o(a.instance.region),1)])]),s("div",null,[t(M,{push:""},{default:e(()=>[t(f,{color:"primary",icon:"mdi-restart",label:"Restart",onClick:r.confirmRestart,disable:a.instance.status!=="running"},null,8,["onClick","disable"]),t(f,{color:"negative",icon:"mdi-stop",label:"Stop",onClick:r.confirmStop,disable:a.instance.status==="stopped"},null,8,["onClick","disable"]),t(f,{color:"positive",icon:"mdi-play",label:"Start",onClick:r.confirmStart,disable:a.instance.status==="running"},null,8,["onClick","disable"]),t(f,{color:"secondary",icon:"mdi-console",label:"Console",onClick:r.openConsole},null,8,["onClick"])]),_:1})])]),s("div",T,[s("div",G,[t(g,null,{default:e(()=>[t(d,null,{default:e(()=>[l[9]||(l[9]=s("div",{class:"text-h6 q-mb-md"},"Instance Details",-1)),t(U,null,{default:e(()=>[t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[3]||(l[3]=[n("Status",-1)])),_:1,__:[3]}),t(u,null,{default:e(()=>[t(Q,{color:r.getStatusColor(a.instance.status),"text-color":"white",size:"sm",dense:""},{default:e(()=>[n(o(a.instance.status),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[4]||(l[4]=[n("Type",-1)])),_:1,__:[4]}),t(u,null,{default:e(()=>[n(o(a.instance.type.toUpperCase()),1)]),_:1})]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[5]||(l[5]=[n("Region",-1)])),_:1,__:[5]}),t(u,null,{default:e(()=>[n(o(a.instance.region),1)]),_:1})]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[6]||(l[6]=[n("Size",-1)])),_:1,__:[6]}),t(u,null,{default:e(()=>[n(o(a.instance.size||"Default"),1)]),_:1})]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[7]||(l[7]=[n("Created",-1)])),_:1,__:[7]}),t(u,null,{default:e(()=>[n(o(r.formatDate(a.instance.created_at)),1)]),_:1})]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(p,null,{default:e(()=>[t(u,{caption:""},{default:e(()=>l[8]||(l[8]=[n("Last Updated",-1)])),_:1,__:[8]}),t(u,null,{default:e(()=>[n(o(r.formatDate(a.instance.updated_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1,__:[9]})]),_:1}),a.instance.metadata&&Object.keys(a.instance.metadata).length>0?(_(),y(g,{key:0,class:"q-mt-md"},{default:e(()=>[t(d,null,{default:e(()=>[l[10]||(l[10]=s("div",{class:"text-h6 q-mb-md"},"Metadata",-1)),s("pre",J,o(JSON.stringify(a.instance.metadata,null,2)),1)]),_:1,__:[10]})]),_:1})):v("",!0)]),s("div",Z,[t(g,null,{default:e(()=>[t(d,null,{default:e(()=>[l[11]||(l[11]=s("div",{class:"text-h6 q-mb-md"},"Machines",-1)),t(B,{rows:a.machines,columns:m.machineColumns,"row-key":"id",flat:"",bordered:"",pagination:{rowsPerPage:10}},{"body-cell-state":e(i=>[t(C,{props:i},{default:e(()=>[t(Q,{color:r.getMachineStateColor(i.row.state),"text-color":"white",size:"sm",dense:""},{default:e(()=>[n(o(i.row.state),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-region":e(i=>[t(C,{props:i},{default:e(()=>[n(o(i.row.region),1)]),_:2},1032,["props"])]),"body-cell-createdAt":e(i=>[t(C,{props:i},{default:e(()=>[n(o(r.formatDate(i.row.createdAt)),1)]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1,__:[11]})]),_:1}),a.logs?(_(),y(g,{key:0,class:"q-mt-md"},{default:e(()=>[t(d,null,{default:e(()=>[l[12]||(l[12]=s("div",{class:"text-h6 q-mb-md"},"Recent Logs",-1)),s("div",H,[(_(!0),w(R,null,V(a.logs,(i,I)=>(_(),w("div",{key:I,class:"log-line"},o(i),1))),128)),!a.logs||a.logs.length===0?(_(),w("div",K," No logs available ")):v("",!0)])]),_:1,__:[12]})]),_:1})):v("",!0),a.metrics?(_(),y(g,{key:1,class:"q-mt-md"},{default:e(()=>[t(d,null,{default:e(()=>[l[15]||(l[15]=s("div",{class:"text-h6 q-mb-md"},"Metrics",-1)),s("div",W,[s("div",X,[t(g,{flat:"",bordered:""},{default:e(()=>[t(d,null,{default:e(()=>[l[13]||(l[13]=s("div",{class:"text-subtitle2"},"CPU Usage",-1)),s("div",Y,o(r.formatMetric(a.metrics.cpu))+"%",1)]),_:1,__:[13]})]),_:1})]),s("div",$,[t(g,{flat:"",bordered:""},{default:e(()=>[t(d,null,{default:e(()=>[l[14]||(l[14]=s("div",{class:"text-subtitle2"},"Memory Usage",-1)),s("div",tt,o(r.formatMetric(a.metrics.memory))+"%",1)]),_:1,__:[14]})]),_:1})])])]),_:1,__:[15]})]),_:1})):v("",!0)])]),t(x,{modelValue:m.showRestartDialog,"onUpdate:modelValue":l[0]||(l[0]=i=>m.showRestartDialog=i)},{default:e(()=>[t(g,{style:{"min-width":"300px"}},{default:e(()=>[t(d,null,{default:e(()=>l[16]||(l[16]=[s("div",{class:"text-h6"},"Restart Instance",-1)])),_:1,__:[16]}),t(d,null,{default:e(()=>l[17]||(l[17]=[n(" Are you sure you want to restart this instance? All machines will be restarted. ",-1)])),_:1,__:[17]}),t(S,{align:"right"},{default:e(()=>[b(t(f,{flat:"",label:"Cancel"},null,512),[[k]]),t(f,{flat:"",label:"Restart",color:"primary",onClick:r.restartInstance,loading:m.actionLoading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(x,{modelValue:m.showStopDialog,"onUpdate:modelValue":l[1]||(l[1]=i=>m.showStopDialog=i)},{default:e(()=>[t(g,{style:{"min-width":"300px"}},{default:e(()=>[t(d,null,{default:e(()=>l[18]||(l[18]=[s("div",{class:"text-h6"},"Stop Instance",-1)])),_:1,__:[18]}),t(d,null,{default:e(()=>l[19]||(l[19]=[n(" Are you sure you want to stop this instance? All machines will be stopped. ",-1)])),_:1,__:[19]}),t(S,{align:"right"},{default:e(()=>[b(t(f,{flat:"",label:"Cancel"},null,512),[[k]]),t(f,{flat:"",label:"Stop",color:"negative",onClick:r.stopInstance,loading:m.actionLoading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(x,{modelValue:m.showStartDialog,"onUpdate:modelValue":l[2]||(l[2]=i=>m.showStartDialog=i)},{default:e(()=>[t(g,{style:{"min-width":"300px"}},{default:e(()=>[t(d,null,{default:e(()=>l[20]||(l[20]=[s("div",{class:"text-h6"},"Start Instance",-1)])),_:1,__:[20]}),t(d,null,{default:e(()=>l[21]||(l[21]=[n(" Are you sure you want to start this instance? All machines will be started. ",-1)])),_:1,__:[21]}),t(S,{align:"right"},{default:e(()=>[b(t(f,{flat:"",label:"Cancel"},null,512),[[k]]),t(f,{flat:"",label:"Start",color:"positive",onClick:r.startInstance,loading:m.actionLoading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Qt=F(j,[["render",et],["__scopeId","data-v-309747fd"]]);export{Qt as default};
