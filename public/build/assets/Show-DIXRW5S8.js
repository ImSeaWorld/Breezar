import{r as q,c as u,o as d,w as e,a as r,b as t,t as o,i as _,Q as g,f as a,e as h,g as b,R as k,S as D,h as I,j as z}from"./app-B9ngRPxC.js";import{Q as c}from"./QItemLabel-CDx0sUKF.js";import{a as Q}from"./QSelect-U9GO-vcy.js";import{Q as f}from"./QItemSection-Dr7pKUWg.js";import{Q as y}from"./QItem-DGC_oh8H.js";import{Q as C}from"./QList-CauX3dmB.js";import{_ as L,Q as w,a as p}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as R}from"./QSeparator-DlYTESWS.js";import{Q as T,a as A}from"./QTable-BWQ-_2Rh.js";import{Q as V}from"./QCardActions-BXiB0Jwk.js";import{Q as B}from"./QDialog-Bd7-soYq.js";import{A as F,C as N}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./format-DSaZ9Sxz.js";import"./use-model-toggle-D3uVg552.js";import"./use-timeout-BLTl8fd9.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const j={components:{AuthenticatedLayout:F},props:{client:Object,recentActivities:Array},data(){return{showDeleteDialog:!1,deleting:!1,syncing:!1,instanceColumns:[{name:"fly_app_id",label:"App ID",field:"fly_app_id",align:"left"},{name:"type",label:"Type",field:"type",align:"center"},{name:"region",label:"Region",field:"region",align:"left"},{name:"status",label:"Status",field:"status",align:"center"},{name:"actions",label:"Actions",align:"center"}]}},methods:{formatDate(s){return new Date(s).toLocaleDateString()},formatDateTime(s){return new Date(s).toLocaleString()},formatActivity(s){const l={client_created:"created this client",client_updated:"updated this client",fly_sync_completed:"synced Fly.io instances",fly_sync_failed:"failed to sync Fly.io instances"};return`${s.user.name} ${l[s.action]||s.action}`},getActivityIcon(s){return{client_created:"mdi-plus-circle",client_updated:"mdi-pencil",fly_sync_completed:"mdi-sync",fly_sync_failed:"mdi-sync-alert"}[s]||"mdi-information"},getStatusColor(s){return{running:"positive",stopped:"negative",partial:"warning",not_deployed:"grey",no_machines:"grey"}[s]||"grey"},editClient(){this.$inertia.visit(route("clients.edit",this.client.id))},confirmDelete(){this.showDeleteDialog=!0},deleteClient(){this.deleting=!0,this.$inertia.delete(route("clients.destroy",this.client.id),{onSuccess:()=>{this.$q.notify({type:"positive",message:"Client deleted successfully"})},onError:()=>{this.$q.notify({type:"negative",message:"Failed to delete client"})},onFinish:()=>{this.deleting=!1}})},syncInstances(){this.syncing=!0,this.$inertia.post(route("fly-sync.run"),{client_id:this.client.id},{preserveScroll:!0,onSuccess:()=>{this.$q.notify({type:"positive",message:"Sync job dispatched"})},onFinish:()=>{this.syncing=!1}})},viewInstance(s){this.$inertia.visit(route("instances.show",s))},viewReport(s){this.$inertia.visit(route("reports.show",s))}}},E={class:"q-gutter-md"},U={class:"row items-center justify-between q-mb-md"},O={class:"text-h5"},P={class:"text-caption text-grey-7"},G={class:"row q-col-gutter-md"},H={class:"col-12 col-md-4"},J={class:"col-12 col-md-8"},K={class:"row items-center justify-between q-mb-md"},M={class:"q-ml-sm"};function W(s,l,n,X,v,m){const x=q("AuthenticatedLayout");return d(),u(x,null,{default:e(()=>[r("div",E,[r("div",U,[r("div",null,[r("div",O,o(n.client.name),1),r("div",P,o(n.client.fly_org_id),1)]),r("div",null,[s.$page.props.auth.user.role==="admin"?(d(),u(g,{key:0,color:"primary",icon:"mdi-pencil",label:"Edit",onClick:m.editClient,class:"q-mr-sm"},null,8,["onClick"])):_("",!0),s.$page.props.auth.user.role==="admin"?(d(),u(g,{key:1,color:"negative",icon:"mdi-delete",label:"Delete",onClick:m.confirmDelete},null,8,["onClick"])):_("",!0)])]),r("div",G,[r("div",H,[t(w,null,{default:e(()=>[t(p,null,{default:e(()=>[l[4]||(l[4]=r("div",{class:"text-h6 q-mb-md"},"Client Details",-1)),t(C,null,{default:e(()=>[t(y,null,{default:e(()=>[t(f,null,{default:e(()=>[t(c,{caption:""},{default:e(()=>l[1]||(l[1]=[a("Status",-1)])),_:1,__:[1]}),t(c,null,{default:e(()=>[t(Q,{color:n.client.status==="active"?"positive":"negative","text-color":"white",size:"sm",dense:""},{default:e(()=>[a(o(n.client.status),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),n.client.billing_start_date?(d(),u(y,{key:0},{default:e(()=>[t(f,null,{default:e(()=>[t(c,{caption:""},{default:e(()=>l[2]||(l[2]=[a("Billing Start Date",-1)])),_:1,__:[2]}),t(c,null,{default:e(()=>[a(o(m.formatDate(n.client.billing_start_date)),1)]),_:1})]),_:1})]),_:1})):_("",!0),n.client.contact_info?(d(),u(y,{key:1},{default:e(()=>[t(f,null,{default:e(()=>[t(c,{caption:""},{default:e(()=>l[3]||(l[3]=[a("Contact Information",-1)])),_:1,__:[3]}),n.client.contact_info.email?(d(),u(c,{key:0},{default:e(()=>[t(h,{name:"mdi-email",size:"xs"}),a(" "+o(n.client.contact_info.email),1)]),_:1})):_("",!0),n.client.contact_info.phone?(d(),u(c,{key:1},{default:e(()=>[t(h,{name:"mdi-phone",size:"xs"}),a(" "+o(n.client.contact_info.phone),1)]),_:1})):_("",!0),n.client.contact_info.address?(d(),u(c,{key:2},{default:e(()=>[t(h,{name:"mdi-map-marker",size:"xs"}),a(" "+o(n.client.contact_info.address),1)]),_:1})):_("",!0)]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1,__:[4]}),t(R),t(p,null,{default:e(()=>[l[6]||(l[6]=r("div",{class:"text-h6 q-mb-md"},"Assigned Users",-1)),t(C,null,{default:e(()=>[(d(!0),b(k,null,D(n.client.users,i=>(d(),u(y,{key:i.id},{default:e(()=>[t(f,{avatar:""},{default:e(()=>[t(I,{color:"primary","text-color":"white",size:"sm"},{default:e(()=>[a(o(i.name.charAt(0)),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(c,null,{default:e(()=>[a(o(i.name),1)]),_:2},1024),t(c,{caption:""},{default:e(()=>[a(o(i.email),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),n.client.users.length===0?(d(),u(y,{key:0},{default:e(()=>[t(f,null,{default:e(()=>[t(c,{class:"text-grey-6"},{default:e(()=>l[5]||(l[5]=[a("No users assigned",-1)])),_:1,__:[5]})]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1,__:[6]})]),_:1})]),r("div",J,[t(w,null,{default:e(()=>[t(p,null,{default:e(()=>[r("div",K,[l[7]||(l[7]=r("div",{class:"text-h6"},"Instances",-1)),t(g,{color:"primary",size:"sm",icon:"mdi-sync",label:"Sync",onClick:m.syncInstances,loading:v.syncing},null,8,["onClick","loading"])]),t(T,{rows:n.client.instances,columns:v.instanceColumns,"row-key":"id",flat:"",bordered:""},{"body-cell-type":e(i=>[t(A,{props:i},{default:e(()=>[t(Q,{size:"sm",dense:""},{default:e(()=>[a(o(i.row.type.toUpperCase()),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-status":e(i=>[t(A,{props:i},{default:e(()=>[t(Q,{color:m.getStatusColor(i.row.status),"text-color":"white",size:"sm",dense:""},{default:e(()=>[a(o(i.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-actions":e(i=>[t(A,{props:i},{default:e(()=>[t(g,{size:"sm",flat:"",dense:"",icon:"mdi-eye",onClick:S=>m.viewInstance(i.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1}),t(w,{class:"q-mt-md"},{default:e(()=>[t(p,null,{default:e(()=>[l[9]||(l[9]=r("div",{class:"text-h6 q-mb-md"},"Recent Reports",-1)),t(C,null,{default:e(()=>[(d(!0),b(k,null,D(n.client.reports,i=>(d(),u(y,{key:i.id},{default:e(()=>[t(f,null,{default:e(()=>[t(c,null,{default:e(()=>[a(o(i.type)+" Report",1)]),_:2},1024),t(c,{caption:""},{default:e(()=>[a(o(m.formatDate(i.report_month)),1)]),_:2},1024)]),_:2},1024),t(f,{side:""},{default:e(()=>[t(g,{size:"sm",flat:"",icon:"mdi-eye",onClick:S=>m.viewReport(i.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),n.client.reports.length===0?(d(),u(y,{key:0},{default:e(()=>[t(f,null,{default:e(()=>[t(c,{class:"text-grey-6"},{default:e(()=>l[8]||(l[8]=[a("No reports available",-1)])),_:1,__:[8]})]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1,__:[9]})]),_:1}),t(w,{class:"q-mt-md"},{default:e(()=>[t(p,null,{default:e(()=>[l[10]||(l[10]=r("div",{class:"text-h6 q-mb-md"},"Recent Activities",-1)),t(C,null,{default:e(()=>[(d(!0),b(k,null,D(n.recentActivities,i=>(d(),u(y,{key:i.id},{default:e(()=>[t(f,{avatar:""},{default:e(()=>[t(h,{name:m.getActivityIcon(i.action)},null,8,["name"])]),_:2},1024),t(f,null,{default:e(()=>[t(c,null,{default:e(()=>[a(o(m.formatActivity(i)),1)]),_:2},1024),t(c,{caption:""},{default:e(()=>[a(o(m.formatDateTime(i.created_at)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1,__:[10]})]),_:1})])]),t(B,{modelValue:v.showDeleteDialog,"onUpdate:modelValue":l[0]||(l[0]=i=>v.showDeleteDialog=i)},{default:e(()=>[t(w,null,{default:e(()=>[t(p,{class:"row items-center"},{default:e(()=>[t(h,{name:"mdi-alert",color:"negative",size:"2rem"}),r("span",M,' Are you sure you want to delete client "'+o(n.client.name)+'"? ',1)]),_:1}),t(p,null,{default:e(()=>l[11]||(l[11]=[a(" This action cannot be undone. All associated data will be permanently deleted. ",-1)])),_:1,__:[11]}),t(V,{align:"right"},{default:e(()=>[z(t(g,{flat:"",label:"Cancel"},null,512),[[N]]),t(g,{flat:"",label:"Delete",color:"negative",onClick:m.deleteClient,loading:v.deleting},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Ce=L(j,[["render",W]]);export{Ce as default};
