import{d as h,r as v,c as b,o as y,w as e,a,b as t,Q as n,e as S,f as s,t as u,j as C}from"./app-B9ngRPxC.js";import{Q as D}from"./QInput-CJt-xT-X.js";import{_ as x,Q as _,a as g}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q,a as p}from"./QTable-BWQ-_2Rh.js";import{a as k}from"./QSelect-U9GO-vcy.js";import{Q as m}from"./QTooltip-BzpgTjjf.js";import{Q as V}from"./QCardActions-BXiB0Jwk.js";import{Q as q}from"./QDialog-Bd7-soYq.js";import{A,C as z}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./QSeparator-DlYTESWS.js";import"./QList-CauX3dmB.js";import"./use-timeout-BLTl8fd9.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QItem-DGC_oh8H.js";import"./QItemSection-Dr7pKUWg.js";import"./QItemLabel-CDx0sUKF.js";import"./format-DSaZ9Sxz.js";import"./use-model-toggle-D3uVg552.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const B={components:{AuthenticatedLayout:A},props:{scripts:Object,filters:Object},data(){return{showDeleteDialog:!1,selectedScript:null,deleting:!1,columns:[{name:"name",label:"Script",field:"name",align:"left"},{name:"creator",label:"Created By",align:"left"},{name:"executions_count",label:"Executions",field:"executions_count",align:"center"},{name:"last_run_at",label:"Last Run",field:"last_run_at",align:"left"},{name:"actions",label:"Actions",align:"center"}]}},computed:{tablePagination(){return{page:this.scripts.current_page,rowsPerPage:this.scripts.per_page,rowsNumber:this.scripts.total}}},methods:{formatDate(o){return new Date(o).toLocaleString()},applyFilters(){this.$inertia.get(route("scripts.index"),this.filters,{preserveState:!0,preserveScroll:!0})},debouncedSearch:h(function(){this.applyFilters()},500),onRequest(o){const{page:l}=o.pagination;this.$inertia.get(route("scripts.index"),{...this.filters,page:l},{preserveState:!0,preserveScroll:!0})},viewScript(o){this.$inertia.visit(route("scripts.show",o))},editScript(o){this.$inertia.visit(route("scripts.edit",o))},executeScript(o){this.$inertia.visit(route("scripts.show",o))},confirmDelete(o){this.selectedScript=o,this.showDeleteDialog=!0},deleteScript(){this.deleting=!0,this.$inertia.delete(route("scripts.destroy",this.selectedScript.id),{onSuccess:()=>{this.$q.notify({type:"positive",message:"Script deleted successfully"}),this.showDeleteDialog=!1},onError:()=>{this.$q.notify({type:"negative",message:"Failed to delete script"})},onFinish:()=>{this.deleting=!1}})}}},L={class:"q-gutter-md"},N={class:"row items-center justify-between q-mb-md"},P={class:"text-weight-medium"},R={class:"text-caption text-grey-7"};function T(o,l,f,j,c,r){const w=v("AuthenticatedLayout");return y(),b(w,null,{default:e(()=>[a("div",L,[a("div",N,[l[3]||(l[3]=a("div",{class:"text-h5"},"Scripts",-1)),t(n,{color:"primary",icon:"mdi-plus",label:"Create Script",onClick:l[0]||(l[0]=i=>o.$inertia.visit(o.route("scripts.create")))})]),t(_,null,{default:e(()=>[t(g,null,{default:e(()=>[t(D,{modelValue:f.filters.search,"onUpdate:modelValue":[l[1]||(l[1]=i=>f.filters.search=i),r.debouncedSearch],label:"Search scripts",filled:"",clearable:""},{prepend:e(()=>[t(S,{name:"mdi-magnify"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1}),t(_,null,{default:e(()=>[t(Q,{rows:f.scripts.data,columns:c.columns,"row-key":"id",flat:"",pagination:r.tablePagination,onRequest:r.onRequest},{"body-cell-name":e(i=>[t(p,{props:i},{default:e(()=>[a("div",null,[a("div",P,u(i.row.name),1),a("div",R,u(i.row.description),1)])]),_:2},1032,["props"])]),"body-cell-creator":e(i=>[t(p,{props:i},{default:e(()=>{var d;return[s(u(((d=i.row.creator)==null?void 0:d.name)||"Unknown"),1)]}),_:2},1032,["props"])]),"body-cell-executions_count":e(i=>[t(p,{props:i},{default:e(()=>[t(k,{size:"sm"},{default:e(()=>[s(u(i.row.executions_count),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-last_run_at":e(i=>[t(p,{props:i},{default:e(()=>[s(u(i.row.last_run_at?r.formatDate(i.row.last_run_at):"Never"),1)]),_:2},1032,["props"])]),"body-cell-actions":e(i=>[t(p,{props:i},{default:e(()=>[t(n,{size:"sm",flat:"",dense:"",icon:"mdi-eye",onClick:d=>r.viewScript(i.row.id)},{default:e(()=>[t(m,null,{default:e(()=>l[4]||(l[4]=[s("View",-1)])),_:1,__:[4]})]),_:2},1032,["onClick"]),t(n,{size:"sm",flat:"",dense:"",icon:"mdi-play",color:"positive",onClick:d=>r.executeScript(i.row.id)},{default:e(()=>[t(m,null,{default:e(()=>l[5]||(l[5]=[s("Execute",-1)])),_:1,__:[5]})]),_:2},1032,["onClick"]),t(n,{size:"sm",flat:"",dense:"",icon:"mdi-pencil",onClick:d=>r.editScript(i.row.id)},{default:e(()=>[t(m,null,{default:e(()=>l[6]||(l[6]=[s("Edit",-1)])),_:1,__:[6]})]),_:2},1032,["onClick"]),t(n,{size:"sm",flat:"",dense:"",icon:"mdi-delete",color:"negative",onClick:d=>r.confirmDelete(i.row)},{default:e(()=>[t(m,null,{default:e(()=>l[7]||(l[7]=[s("Delete",-1)])),_:1,__:[7]})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"])]),_:1}),t(q,{modelValue:c.showDeleteDialog,"onUpdate:modelValue":l[2]||(l[2]=i=>c.showDeleteDialog=i)},{default:e(()=>[t(_,{style:{"min-width":"300px"}},{default:e(()=>[t(g,null,{default:e(()=>l[8]||(l[8]=[a("div",{class:"text-h6"},"Delete Script",-1)])),_:1,__:[8]}),t(g,null,{default:e(()=>{var i;return[s(' Are you sure you want to delete script "'+u((i=c.selectedScript)==null?void 0:i.name)+'"? This action cannot be undone. ',1)]}),_:1}),t(V,{align:"right"},{default:e(()=>[C(t(n,{flat:"",label:"Cancel"},null,512),[[z]]),t(n,{flat:"",label:"Delete",color:"negative",onClick:r.deleteScript,loading:c.deleting},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const ce=x(B,[["render",T]]);export{ce as default};
