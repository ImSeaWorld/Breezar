import{Q as x,a as l}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{J as F,E as m,L as w,c as b,o as c,w as t,a,b as o,t as g,Q as h,M as r,g as _,i as C}from"./app-B9ngRPxC.js";import{Q as k}from"./QInput-CJt-xT-X.js";import{Q as S}from"./QForm-QL7SKRAj.js";import{Q as V}from"./QCardActions-BXiB0Jwk.js";import{Q as E}from"./QDialog-Bd7-soYq.js";import{A as T}from"./Authenticated-Bi_brb96.js";import{u as B}from"./use-quasar-BSYRNlz7.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./format-DSaZ9Sxz.js";import"./QList-CauX3dmB.js";import"./use-timeout-BLTl8fd9.js";import"./use-model-toggle-D3uVg552.js";import"./QToolbar-tVFOb00I.js";import"./QItemSection-Dr7pKUWg.js";import"./QItemLabel-CDx0sUKF.js";import"./QItem-DGC_oh8H.js";import"./QSeparator-DlYTESWS.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const D={class:"py-12"},q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},N={class:"text-lg font-medium text-gray-900"},R={class:"mt-1 text-sm text-gray-600"},U=["src"],I={class:"bg-gray-100 px-2 py-1 rounded"},ie={__name:"TwoFactor",props:{enabled:Boolean},setup(p){const i=B();F();const f=m(!1),n=m(!1),y=m(""),v=m(""),s=w({code:""}),Q=async()=>{f.value=!0;try{await s.post(route("2fa.enable"),{preserveScroll:!0,onSuccess:d=>{d.props.flash.qrCode&&(y.value=d.props.flash.qrCode,v.value=d.props.flash.secret,n.value=!0),i.notify({type:"positive",message:"2FA has been enabled successfully"})},onError:()=>{i.notify({type:"negative",message:"Failed to enable 2FA"})}})}finally{f.value=!1}},A=()=>{s.post(route("2fa.disable"),{preserveScroll:!0,onSuccess:()=>{i.notify({type:"positive",message:"2FA has been disabled"}),s.reset()},onError:()=>{i.notify({type:"negative",message:"Invalid authentication code"})}})};return(d,e)=>(c(),b(T,null,{header:t(()=>e[3]||(e[3]=[a("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Two-Factor Authentication ",-1)])),default:t(()=>[a("div",D,[a("div",q,[o(x,{class:"p-6"},{default:t(()=>[o(l,null,{default:t(()=>[a("h3",N,g(p.enabled?"Two-Factor Authentication is Enabled":"Enable Two-Factor Authentication"),1),a("p",R,g(p.enabled?"Two-factor authentication adds an additional layer of security to your account.":"When two-factor authentication is enabled, you will be prompted for a secure, random token during authentication."),1)]),_:1}),p.enabled?(c(),b(l,{key:1},{default:t(()=>[o(S,{onSubmit:A,class:"space-y-4"},{default:t(()=>[o(k,{modelValue:r(s).code,"onUpdate:modelValue":e[0]||(e[0]=u=>r(s).code=u),label:"Authentication Code",hint:"Enter your 6-digit authentication code to disable 2FA",error:!!r(s).errors.code,"error-message":r(s).errors.code,mask:"######",filled:""},null,8,["modelValue","error","error-message"]),o(h,{type:"submit",color:"negative",label:"Disable 2FA",loading:r(s).processing},null,8,["loading"])]),_:1})]),_:1})):(c(),b(l,{key:0},{default:t(()=>[o(h,{color:"primary",label:"Enable 2FA",onClick:Q,loading:f.value},null,8,["loading"])]),_:1}))]),_:1}),o(E,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=u=>n.value=u),persistent:""},{default:t(()=>[o(x,{style:{"min-width":"400px"}},{default:t(()=>[o(l,null,{default:t(()=>e[4]||(e[4]=[a("div",{class:"text-h6"},"Set Up Two-Factor Authentication",-1)])),_:1,__:[4]}),o(l,{class:"text-center"},{default:t(()=>[e[5]||(e[5]=a("p",{class:"mb-4"},"Scan this QR code with your authenticator app:",-1)),y.value?(c(),_("img",{key:0,src:y.value,alt:"2FA QR Code",class:"mx-auto mb-4"},null,8,U)):C("",!0),e[6]||(e[6]=a("p",{class:"text-sm text-gray-600 mb-2"},"Or enter this code manually:",-1)),a("code",I,g(v.value),1)]),_:1,__:[5,6]}),o(V,{align:"right"},{default:t(()=>[o(h,{flat:"",label:"Done",color:"primary",onClick:e[1]||(e[1]=u=>n.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}};export{ie as default};
