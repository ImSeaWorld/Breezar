import{v as a,ap as xe,m as Ce,D as ke,E as Y,p as g,F as $,B as qe,q as _,T as Le,H as Oe,a3 as oe,aK as He,A as ne,at as Q,ar as d,aL as Be}from"./app-B9ngRPxC.js";import{s as Fe,v as Me,a as j,u as Ae,w as De,c as Ke,d as Re,e as We,f as Ve,h as ze,p as I,i as Xe,r as U,g as Ye,x as $e,j as _e,n as Qe,m as je,y as Ie}from"./QList-CauX3dmB.js";import{u as Ue,a as Ge,b as Je}from"./use-model-toggle-D3uVg552.js";import{u as Ne,b as Ze}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{u as et}from"./use-timeout-BLTl8fd9.js";import{a as tt}from"./focus-manager-BJWzFvJg.js";const v=[];let w;function ot(e){w=e.keyCode===27}function nt(){w===!0&&(w=!1)}function it(e){w===!0&&(w=!1,xe(e,27)===!0&&v[v.length-1](e))}function ie(e){window[e]("keydown",ot),window[e]("blur",nt),window[e]("keyup",it),w=!1}function st(e){a.is.desktop===!0&&(v.push(e),v.length===1&&ie("addEventListener"))}function G(e){const t=v.indexOf(e);t!==-1&&(v.splice(t,1),v.length===0&&ie("removeEventListener"))}const h=[];function se(e){h[h.length-1](e)}function lt(e){a.is.desktop===!0&&(h.push(e),h.length===1&&document.body.addEventListener("focusin",se))}function rt(e){const t=h.indexOf(e);t!==-1&&(h.splice(t,1),h.length===0&&document.body.removeEventListener("focusin",se))}const wt=Ce({name:"QMenu",inheritAttrs:!1,props:{...De,...Ge,...Ne,...Ae,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:j},self:{type:String,validator:j},offset:{type:Array,validator:Me},scrollTarget:Fe,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Ue,"click","escapeKey"],setup(e,{slots:t,emit:s,attrs:n}){let i=null,r,l,P;const B=ke(),{proxy:S}=B,{$q:u}=S,c=Y(null),m=Y(!1),le=g(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),re=Ze(e,u),{registerTick:ae,removeTick:ue}=Ke(),{registerTimeout:F}=et(),{transitionProps:ce,transitionStyle:de}=Re(e),{localScrollTarget:M,changeScrollEvent:fe,unconfigureScrollTarget:ve}=We(e,z),{anchorEl:y,canShow:he}=Ve({showing:m}),{hide:A}=Je({showing:m,canShow:he,handleShow:pe,handleHide:Te,hideOnRouteChange:le,processOnMount:!0}),{showPortal:D,hidePortal:K,renderPortal:me}=ze(B,c,Ee,"menu"),x={anchorEl:y,innerRef:c,onClickOutside(o){if(e.persistent!==!0&&m.value===!0)return A(o),(o.type==="touchstart"||o.target.classList.contains("q-dialog__backdrop"))&&ne(o),!0}},R=g(()=>I(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),ge=g(()=>e.cover===!0?R.value:I(e.self||"top start",u.lang.rtl)),we=g(()=>(e.square===!0?" q-menu--square":"")+(re.value===!0?" q-menu--dark q-dark":"")),ye=g(()=>e.autoClose===!0?{onClick:be}:{}),W=g(()=>m.value===!0&&e.persistent!==!0);$(W,o=>{o===!0?(st(k),Xe(x)):(G(k),U(x))});function C(){tt(()=>{let o=c.value;o&&o.contains(document.activeElement)!==!0&&(o=o.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.querySelector("[autofocus], [data-autofocus]")||o,o.focus({preventScroll:!0}))})}function pe(o){if(i=e.noRefocus===!1?document.activeElement:null,lt(X),D(),z(),r=void 0,o!==void 0&&(e.touchPosition||e.contextMenu)){const q=qe(o);if(q.left!==void 0){const{top:Pe,left:Se}=y.value.getBoundingClientRect();r={left:q.left-Se,top:q.top-Pe}}}l===void 0&&(l=$(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,p)),e.noFocus!==!0&&document.activeElement.blur(),ae(()=>{p(),e.noFocus!==!0&&C()}),F(()=>{u.platform.is.ios===!0&&(P=e.autoClose,c.value.click()),p(),D(!0),s("show",o)},e.transitionDuration)}function Te(o){ue(),K(),V(!0),i!==null&&(o===void 0||o.qClickOutside!==!0)&&((((o==null?void 0:o.type.indexOf("key"))===0?i.closest('[tabindex]:not([tabindex^="-"])'):void 0)||i).focus(),i=null),F(()=>{K(!0),s("hide",o)},e.transitionDuration)}function V(o){r=void 0,l!==void 0&&(l(),l=void 0),(o===!0||m.value===!0)&&(rt(X),ve(),U(x),G(k)),o!==!0&&(i=null)}function z(){(y.value!==null||e.scrollTarget!==void 0)&&(M.value=Ye(y.value,e.scrollTarget),fe(M.value,p))}function be(o){P!==!0?($e(S,o),s("click",o)):P=!1}function X(o){W.value===!0&&e.noFocus!==!0&&He(c.value,o.target)!==!0&&C()}function k(o){e.noEscDismiss!==!0&&(s("escapeKey"),A(o))}function p(){_e({targetEl:c.value,offset:e.offset,anchorEl:y.value,anchorOrigin:R.value,selfOrigin:ge.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ee(){return _(Le,ce.value,()=>m.value===!0?_("div",{role:"menu",...n,ref:c,tabindex:-1,class:["q-menu q-position-engine scroll"+we.value,n.class],style:[n.style,de.value],...ye.value},Oe(t.default)):null)}return oe(V),Object.assign(S,{focus:C,updatePosition:p}),me}});function yt(e,t,s){let n;function i(){n!==void 0&&(Q.remove(n),n=void 0)}return oe(()=>{e.value===!0&&i()}),{removeFromHistory:i,addToHistory(){n={condition:()=>s.value===!0,handler:t},Q.add(n)}}}let T=0,L,O,b,H=!1,J,N,Z,f=null;function at(e){ut(e)&&ne(e)}function ut(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=Be(e),s=e.shiftKey&&!e.deltaX,n=!s&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),i=s||n?e.deltaY:e.deltaX;for(let r=0;r<t.length;r++){const l=t[r];if(Ie(l,n))return n?i<0&&l.scrollTop===0?!0:i>0&&l.scrollTop+l.clientHeight===l.scrollHeight:i<0&&l.scrollLeft===0?!0:i>0&&l.scrollLeft+l.clientWidth===l.scrollWidth}return!0}function ee(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function E(e){H!==!0&&(H=!0,requestAnimationFrame(()=>{H=!1;const{height:t}=e.target,{clientHeight:s,scrollTop:n}=document.scrollingElement;(b===void 0||t!==window.innerHeight)&&(b=s-t,document.scrollingElement.scrollTop=n),n>b&&(document.scrollingElement.scrollTop-=Math.ceil((n-b)/8))}))}function te(e){const t=document.body,s=window.visualViewport!==void 0;if(e==="add"){const{overflowY:n,overflowX:i}=window.getComputedStyle(t);L=Qe(window),O=je(window),J=t.style.left,N=t.style.top,Z=window.location.href,t.style.left=`-${L}px`,t.style.top=`-${O}px`,i!=="hidden"&&(i==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,a.is.ios===!0&&(s===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",E,d.passiveCapture),window.visualViewport.addEventListener("scroll",E,d.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",ee,d.passiveCapture))}a.is.desktop===!0&&a.is.mac===!0&&window[`${e}EventListener`]("wheel",at,d.notPassive),e==="remove"&&(a.is.ios===!0&&(s===!0?(window.visualViewport.removeEventListener("resize",E,d.passiveCapture),window.visualViewport.removeEventListener("scroll",E,d.passiveCapture)):window.removeEventListener("scroll",ee,d.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=J,t.style.top=N,window.location.href===Z&&window.scrollTo(L,O),b=void 0)}function ct(e){let t="add";if(e===!0){if(T++,f!==null){clearTimeout(f),f=null;return}if(T>1)return}else{if(T===0||(T--,T>0))return;if(t="remove",a.is.ios===!0&&a.is.nativeMobile===!0){f!==null&&clearTimeout(f),f=setTimeout(()=>{te(t),f=null},100);return}}te(t)}function pt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,ct(t))}}}function Tt(e,t,s){return s<=t?t:Math.min(s,Math.max(t,e))}function bt(e,t,s){if(s<=t)return t;const n=s-t+1;let i=t+(e-t)%n;return i<t&&(i=n+i),i===0?0:i}export{wt as Q,pt as a,Tt as b,lt as c,st as d,G as e,bt as n,rt as r,yt as u};
