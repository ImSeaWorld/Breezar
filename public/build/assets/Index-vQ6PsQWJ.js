import{d as k,r as b,c as u,o as m,w as t,a as p,b as i,i as g,Q as o,e as C,f as r,t as c,j as Q}from"./app-B9ngRPxC.js";import{Q as q}from"./QInput-CJt-xT-X.js";import{Q as P,a as d}from"./QTable-BWQ-_2Rh.js";import{a as f}from"./QSelect-U9GO-vcy.js";import{_ as S,Q as y,a as h}from"./_plugin-vue_export-helper-DE_L9tpe.js";import{Q as V}from"./QCardActions-BXiB0Jwk.js";import{Q as T}from"./QDialog-Bd7-soYq.js";import{A,C as N}from"./Authenticated-Bi_brb96.js";import"./use-key-composition-CcPeSjoe.js";import"./use-id-Bsf40j7l.js";import"./focus-manager-BJWzFvJg.js";import"./QSeparator-DlYTESWS.js";import"./QList-CauX3dmB.js";import"./use-timeout-BLTl8fd9.js";import"./QLinearProgress-azICafWN.js";import"./QCheckbox-C-madECj.js";import"./use-checkbox-D0S0Xvb9.js";import"./QItem-DGC_oh8H.js";import"./QItemSection-Dr7pKUWg.js";import"./QItemLabel-CDx0sUKF.js";import"./format-DSaZ9Sxz.js";import"./use-model-toggle-D3uVg552.js";import"./QToolbar-tVFOb00I.js";import"./QBtnGroup-uFzmfQIw.js";import"./touch-BjYP5sR0.js";const x={components:{AuthenticatedLayout:A},props:{clients:Object,filters:Object},data(){return{search:this.filters.search||"",showDeleteDialog:!1,clientToDelete:null,deleting:!1,columns:[{name:"name",label:"Name",field:"name",align:"left",sortable:!0},{name:"fly_org_id",label:"Fly Org ID",field:"fly_org_id",align:"left"},{name:"status",label:"Status",field:"status",align:"center"},{name:"instances",label:"Instances",align:"center"},{name:"reports",label:"Reports",align:"center"},{name:"billing_start_date",label:"Billing Start",field:"billing_start_date",align:"left"},{name:"actions",label:"Actions",align:"center"}],pagination:{page:this.clients.current_page,rowsPerPage:this.clients.per_page,rowsNumber:this.clients.total}}},methods:{handleSearch:k(function(){this.onRequest({pagination:{page:1,rowsPerPage:this.pagination.rowsPerPage}})},300),onRequest(l){const{page:n,rowsPerPage:_}=l.pagination;this.$inertia.get(route("clients.index"),{page:n,search:this.search},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{this.pagination.page=this.clients.current_page,this.pagination.rowsPerPage=this.clients.per_page,this.pagination.rowsNumber=this.clients.total}})},createClient(){this.$inertia.visit(route("clients.create"))},viewClient(l){this.$inertia.visit(route("clients.show",l))},editClient(l){this.$inertia.visit(route("clients.edit",l))},confirmDelete(l){this.clientToDelete=l,this.showDeleteDialog=!0},deleteClient(){this.deleting=!0,this.$inertia.delete(route("clients.destroy",this.clientToDelete.id),{onSuccess:()=>{this.showDeleteDialog=!1,this.clientToDelete=null,this.$q.notify({type:"positive",message:"Client deleted successfully"})},onError:()=>{this.$q.notify({type:"negative",message:"Failed to delete client"})},onFinish:()=>{this.deleting=!1}})}}},z={class:"q-gutter-md"},I={class:"row items-center justify-between q-mb-md"},R={class:"q-ml-sm"};function B(l,n,_,L,a,s){const v=b("InertiaLink"),D=b("AuthenticatedLayout");return m(),u(D,null,{default:t(()=>[p("div",z,[p("div",I,[n[2]||(n[2]=p("div",{class:"text-h5"},"Clients",-1)),l.$page.props.auth.user.role==="admin"?(m(),u(o,{key:0,color:"primary",icon:"mdi-plus",label:"New Client",onClick:s.createClient},null,8,["onClick"])):g("",!0)]),i(y,null,{default:t(()=>[i(h,null,{default:t(()=>[i(q,{modelValue:a.search,"onUpdate:modelValue":[n[0]||(n[0]=e=>a.search=e),s.handleSearch],label:"Search clients...",filled:"",clearable:"",class:"q-mb-md"},{prepend:t(()=>[i(C,{name:"mdi-magnify"})]),_:1},8,["modelValue","onUpdate:modelValue"]),i(P,{rows:_.clients.data,columns:a.columns,"row-key":"id",pagination:a.pagination,onRequest:s.onRequest,flat:"",bordered:""},{"body-cell-name":t(e=>[i(d,{props:e},{default:t(()=>[i(v,{href:l.route("clients.show",e.row.id),class:"text-primary text-weight-medium"},{default:t(()=>[r(c(e.row.name),1)]),_:2},1032,["href"])]),_:2},1032,["props"])]),"body-cell-status":t(e=>[i(d,{props:e},{default:t(()=>[i(f,{color:e.row.status==="active"?"positive":"negative","text-color":"white",size:"sm",dense:""},{default:t(()=>[r(c(e.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-instances":t(e=>[i(d,{props:e},{default:t(()=>[i(f,{size:"sm",dense:""},{default:t(()=>[r(c(e.row.instances_count)+" instances ",1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-reports":t(e=>[i(d,{props:e},{default:t(()=>[i(f,{size:"sm",dense:""},{default:t(()=>[r(c(e.row.reports_count)+" reports ",1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":t(e=>[i(d,{props:e},{default:t(()=>[i(o,{size:"sm",flat:"",dense:"",icon:"mdi-eye",onClick:w=>s.viewClient(e.row.id)},null,8,["onClick"]),l.$page.props.auth.user.role==="admin"?(m(),u(o,{key:0,size:"sm",flat:"",dense:"",icon:"mdi-pencil",onClick:w=>s.editClient(e.row.id)},null,8,["onClick"])):g("",!0),l.$page.props.auth.user.role==="admin"?(m(),u(o,{key:1,size:"sm",flat:"",dense:"",icon:"mdi-delete",color:"negative",onClick:w=>s.confirmDelete(e.row)},null,8,["onClick"])):g("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"])]),_:1})]),_:1}),i(T,{modelValue:a.showDeleteDialog,"onUpdate:modelValue":n[1]||(n[1]=e=>a.showDeleteDialog=e)},{default:t(()=>[i(y,null,{default:t(()=>[i(h,{class:"row items-center"},{default:t(()=>{var e;return[i(C,{name:"mdi-alert",color:"negative",size:"2rem"}),p("span",R,' Are you sure you want to delete client "'+c((e=a.clientToDelete)==null?void 0:e.name)+'"? ',1)]}),_:1}),i(h,null,{default:t(()=>n[3]||(n[3]=[r(" This action cannot be undone. All associated data will be permanently deleted. ",-1)])),_:1,__:[3]}),i(V,{align:"right"},{default:t(()=>[Q(i(o,{flat:"",label:"Cancel"},null,512),[[N]]),i(o,{flat:"",label:"Delete",color:"negative",onClick:s.deleteClient,loading:a.deleting},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const de=S(x,[["render",B]]);export{de as default};
